extends layout

block content
  main
    h2 #{room} – 상담사 화면
    script.
      window.APP = { name: !{JSON.stringify(name)}, room: !{JSON.stringify(room)}, role: "counselor" };

    .grid(style="display:grid;grid-template-columns:1fr 360px;gap:12px;align-items:start")
      section.panel(style="border:1px solid #e5e7eb;border-radius:12px;padding:12px;height:78vh;display:flex;flex-direction:column;gap:12px;")
        h3 본 채팅
        #messages(style="flex:1;overflow-y:auto;border:1px solid #eee;border-radius:8px;padding:10px;")
        form(onSubmit="return false;" style="display:flex;gap:8px;")
          input#message(type="text" placeholder="내담자에게 보낼 실제 메시지" style="flex:1;")
          button#send(type="button") 전송

      section.panel(style="border:1px solid #e5e7eb;border-radius:12px;padding:12px;height:78vh;display:flex;flex-direction:column;gap:12px;")
        h3 AI 보조 패널
        #draft(style="flex:1;overflow-y:auto;white-space:pre-wrap;border:1px solid #eee;border-radius:8px;padding:10px;min-height:120px;background:#fafafa") (여기에 AI 초안이 표시됩니다)
        textarea#instruction(rows="4" placeholder="AI에 수정/재생성 지시를 작성하세요")
        .row(style="display:flex;gap:8px;")
          button#refine(type="button") AI에 수정 지시 보내기
          button#use-draft(type="button") 초안을 본 채팅으로 전송
        #ai-status.muted(style="margin-top:6px")

    script(src="/socket.io/socket.io.js")
    script(src="/counselor.js")
